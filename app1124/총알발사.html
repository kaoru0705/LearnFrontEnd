<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        #stage{
            width: 1000px;
            height: 700px;
            background-color: yellow;
            margin: auto;
            position: relative;     /* 자식에 position이 명시되었기 때문에 부모인 stage에도 명시해야 함
                                    static + left, top이 적용되는 상태이며, 다른 태그에 의해 위치가 결정되므로
                                    relative라 한다.. 즉 다른 태그의 의해 밀려난 바로 그자리,
                                    자기 자신의 본연의 위치
            */
                                    
        }
    </style>
    <script>
        // 현신의 총알을 정의한다 (즉 클래스를 정의한다.)
        // java, C#에서는 개발자가 클래스를 정의하면, 새로운 자료형을 정의하는 것으로 인정해줌
        // 따라서 문법 형식은 아래와 같다.

        class Bullet{
            constructor(){
                this.x = 0;     // x라는 인스턴스 변수 선언 JS 자동 할당 없음 
                // 일반적인 의미의 전역변수란 프로그램이 끝날 때까지 그 생명력이 유지되는 변수를 의미하는데,
                // 객체지향 언어에서는 class의 영역 바깥쪽에 코드를 작성할 수 없기 때문에 전역변수를 지원하지 ㅇ낳음
                // 그럼 누적은 어떻게 처리하나? OOP언어에서는 개발자가 new에 의해 생성한 인스턴스를 죽이는 방법이
                // 없기 때문에 인스턴스 변수로 선언하면, 그 객체가 죽을 때까지는 그 값이 같이 유지되므로, 전역변수를 사용할 일이 없다!!
                
                // 아래의 코드에 의해 div DOM 객체가 생성됨
                // DOM이란? 태그마다 1:1 대응되는, 즉 태그를 모방한 객체 체계
                // Document Object Model(문서 내의 모든 태그를 모방하여 객체화 시킨 것)
                this.div = document.createElement("div");   // 총알을 시각화시킬 div 태그, <div></div> 동일
                this.div.style.backgroundColor = "red";
                this.div.style.width =  30 + "px";      // block 태그는 너비와 높이가 적용가능
                this.div.style.height = 30 + "px";      // block 태그는 너비와 높이가 적용가능
                this.div.style.borderRadius = 50 + "%";
                
                
                // css에서 자식에 position이 명시되면, 반드시 부모도 position을 명시해야 한다(must)
                this.div.style.position = "absolute";   // 부모를 기준으로 한 위치 속성을 절대위치라 한다.
                this.div.style.left = 0 + "px";
                this.div.style.top = 200 + "px";

                // stage에 부착, 메모리에 올라온 DOM 중 id가 stage인 객체를 접근
                this.stage = document.getElementById("stage");


                // stage에 자식요소로 div를 부착!
                this.stage.appendChild(this.div);

                this.move();
                // 컴퓨터에게 일정 시간 간격으로 this.move()를 호출하도록 부탁!!
                // 아래 보이는 함수정의는 화살표함수를 말하며, java언어에서의 Lambda와 거의 같다...
                // java에서의 람다는 함수형 인터페이스를 의미
                setInterval(()=>{
                    // 화살표 함수내에서의 this는 자기자신의 바로 바깥쪽 Context를 의미할므로, 이 총알 객체의 인스턴스를 의미
                    this.move()
                }, 10);
            }

            move() {
                // 총알을 x축 방향으로 점점 값이 커지면 되기 때문에 left값만 조정하자
                this.x += 10;
                this.div.style.left = this.x + "px";
            }
        }

        // body 즉 문서에 이벤트를 연결할 때는 window 객체 이용 가능
        window.addEventListener("keydown", (e) => {
            if(e.keyCode === 32){
                new Bullet();
            }
        });

        
    </script>
</head>
<body>
    <div id="stage"></div>
</body>
</html>